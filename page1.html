<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8">
<title>Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø´ÙŠØª</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{
  font-family: Tahoma, sans-serif;
  background: #eef2f7;
  direction: rtl;
  padding: 20px;
}
.box{
  max-width: 1000px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
h2{
  text-align: center;
  margin-bottom: 20px;
  color:#333;
}
input{
  width: 70%;
  padding: 12px;
  font-size: 16px;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  padding: 12px 18px;
  font-size:16px;
  margin-left:5px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background: #4CAF50;
  color: #fff;
  transition: background 0.3s;
}
button:hover{ background: #45a049; }

#status{
  margin-top:12px;
  font-weight:bold;
  text-align:center;
}

.card{
  background: #fff;
  border-radius:10px;
  padding:15px;
  margin-top:12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  font-size: 18px;
  line-height:1.6;
  transition: transform 0.2s, box-shadow 0.2s;
  text-align:center;
}
.card:hover{
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.first-card img{
  width:100%;
  max-height:220px;
  object-fit:cover;
  border-radius:8px;
  margin-bottom:10px;
}

.first-title{
  font-size:20px;
  font-weight:bold;
  color:#1976D2;
}

.highlight{
  background: yellow;
  font-weight: bold;
  border-radius: 3px;
  padding:0 3px;
}
</style>
</head>

<body>

<div class="box">
  <h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´ÙŠØª</h2>

  <input id="q" placeholder="Ø§ÙƒØªØ¨ Ø£ÙŠ ÙƒÙ„Ù…Ø©">
  <button onclick="search()">Ø¨Ø­Ø«</button>

  <div id="status">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
  <div id="result"></div>
</div>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/1WyiqUcwgnIwgpO73dxsUDl9mA9KCh0sgeCiNx5oAQ4o/export?format=csv&gid=0";

let data = [];

fetch(CSV_URL)
.then(r => r.text())
.then(csv => {
  csv = csv.replace(/^\uFEFF/, "");
  data = csv.split(/\r?\n/).map(r =>
    r.split(",").map(c => c.replace(/^\"|\"$/g,"").trim())
  );

  document.getElementById("status").innerText =
    "âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­";
})
.catch(()=>{
  document.getElementById("status").innerText =
    "âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
});

function highlightMatch(text, term){
  if(!term) return text;
  const re = new RegExp(`(${term})`, 'gi');
  return text.replace(re, '<span class="highlight">$1</span>');
}

function search(){
  const q = document.getElementById("q").value.toLowerCase().trim();
  if(!q){ alert("Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø«"); return; }

  const results = data.slice(1).filter(r =>
    r.some(c => (c || "").toLowerCase().includes(q))
  );

  document.getElementById("status").innerHTML =
    "ğŸ” Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: <b>" + results.length + "</b>";

  drawCards(results, q);
}

/* âœ… Ø£ÙˆÙ„ Ù‚ÙŠÙ…Ø© ÙƒØ§Ø±Øª Ø¨ØµÙˆØ±Ø© + Ù…Ù†Ø¹ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ§Ø±ØºØ© */
function drawCards(rows, term=""){
  let html = "";

  if(rows.length === 0){
    html = "<p style='text-align:center'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>";
  }

  rows.forEach(row=>{
    let hasValue = row.some(cell => cell && cell.trim() !== "");
    if(hasValue){
      html += `<div style="margin-top:30px"></div>`;
    }

    row.forEach((cell, i)=>{
      if(!cell || cell.trim() === "") return;

      // âœ… Ø£ÙˆÙ„ Ù‚ÙŠÙ…Ø© = ÙƒØ§Ø±Øª Ø¨ØµÙˆØ±Ø©
      if(i === 0){

        const imgURL = cell.startsWith("http") ? cell :
        "https://via.placeholder.com/600x300?text=No+Image";

        html += `
          <div class="card first-card">
            <img src="${imgURL}" onerror="this.src='https://via.placeholder.com/600x300?text=No+Image'">
            <div class="first-title">ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù†ØµØ±</div>
          </div>
        `;
      }else{

        html += `
          <div class="card">
            ${highlightMatch(cell, term)}
          </div>
        `;
      }
    });
  });

  document.getElementById("result").innerHTML = html;
}
</script>

</body>
</html>